"use strict";angular.module(initialState.appName,["ngRoute","pascalprecht.translate","ng-clamp"]).constant("INITIAL_STATE",initialState).config(function($translateProvider){var locale=getLocale(initialState.DEFAULT_LANGUAGE);$translateProvider.translations("cs",{"widget.accessibility.message.days":"Dny","widget.secs.label":"Sekundy","widget.oncomplete.text":"Odpočítávání skončilo!","widget.accessibility.message.less_than_minute":"zbývá méně než minuta","widget.accessibility.message.remaining":"zbývá","widget.hours.label":"Hodiny","widget.accessibility.message.over":"počet je u konce","widget.accessibility.message.minutes":"minuty","widget.days.label":"dnů","widget.accessibility.message.hours":"hodiny","widget.description":"Odpočítávadlo","widget.minutes.label":"Min"});$translateProvider.translations("da",{"widget.accessibility.message.days":"dage","widget.secs.label":"Sek.","widget.oncomplete.text":"Nedtællingen er slut!","widget.accessibility.message.less_than_minute":"der er mindre end et minut tilbage","widget.accessibility.message.remaining":"tilbage","widget.hours.label":"Timer","widget.accessibility.message.over":"det er slut","widget.accessibility.message.minutes":"minutter","widget.days.label":"dage","widget.accessibility.message.hours":"timer","widget.description":"Nedtællingsur","widget.minutes.label":"Min"});$translateProvider.translations("de",{"widget.accessibility.message.days":"Tage","widget.secs.label":"Sek.","widget.oncomplete.text":"Ende des Countdown!","widget.accessibility.message.less_than_minute":"nur noch eine Minute verbleibt","widget.accessibility.message.remaining":"übrig","widget.hours.label":"Stunden","widget.accessibility.message.over":"Die Zählung ist vorbei","widget.accessibility.message.minutes":"Minuten","widget.days.label":"Tage","widget.accessibility.message.hours":"Stunden","widget.description":"Countdown-Anzeige","widget.minutes.label":"Min."});$translateProvider.translations("en",{"widget.description":"Countdown clock","widget.accessibility.message.days":"days","widget.accessibility.message.hours":"hours","widget.accessibility.message.minutes":"minutes","widget.accessibility.message.remaining":"remaining","widget.accessibility.message.over":"count is over","widget.accessibility.message.less_than_minute":"less than a minute remaining","widget.days.label":"Days","widget.minutes.label":"Mins","widget.hours.label":"Hours","widget.secs.label":"Secs","widget.oncomplete.text":"Countdown over!"});$translateProvider.translations("es",{"widget.accessibility.message.days":"días","widget.secs.label":"Seg.","widget.oncomplete.text":"¡Cuenta regresiva finalizada!","widget.accessibility.message.less_than_minute":"falta menos de un minuto","widget.accessibility.message.remaining":"restante/s","widget.hours.label":"Horas","widget.accessibility.message.over":"la cuenta terminó","widget.accessibility.message.minutes":"minutos.","widget.days.label":"Días","widget.accessibility.message.hours":"Horas","widget.description":"Reloj de cuenta regresiva","widget.minutes.label":"Min."});$translateProvider.translations("fi",{"widget.accessibility.message.days":"päivää","widget.secs.label":"Secs","widget.oncomplete.text":"Countdown over!","widget.accessibility.message.less_than_minute":"less than a minute remaining","widget.accessibility.message.remaining":"remaining","widget.hours.label":"Tuntia","widget.accessibility.message.over":"count is over","widget.accessibility.message.minutes":"minuuttia","widget.days.label":"Päivää","widget.accessibility.message.hours":"tuntia","widget.description":"Countdown clock","widget.minutes.label":"Mins"});$translateProvider.translations("fr",{"widget.accessibility.message.days":"jours","widget.secs.label":"Secs.","widget.oncomplete.text":"Compte à rebours terminé !","widget.accessibility.message.less_than_minute":"Moins d'une minute restante","widget.accessibility.message.remaining":"reste","widget.hours.label":"Heures","widget.accessibility.message.over":"Compte terminé","widget.accessibility.message.minutes":"minutes","widget.days.label":"Jours","widget.accessibility.message.hours":"heures","widget.description":"Compte à Rebours","widget.minutes.label":"Min."});$translateProvider.translations("hi",{"widget.accessibility.message.days":"दिन","widget.secs.label":"सेकेंड","widget.oncomplete.text":"उलटी गिनती समाप्त!","widget.accessibility.message.less_than_minute":"एक मिनट से भी कम समय शेष रह गया है","widget.accessibility.message.remaining":"शेष है","widget.hours.label":"घंटे","widget.accessibility.message.over":"गिनती समाप्त हुई","widget.accessibility.message.minutes":"मिनट","widget.days.label":"दिन","widget.accessibility.message.hours":"घंटे","widget.description":"उलटी गिनती की घड़ी","widget.minutes.label":"मिनट"});$translateProvider.translations("it",{"widget.accessibility.message.days":"giorni","widget.secs.label":"Sec","widget.oncomplete.text":"Il conto alla rovescia è terminato!","widget.accessibility.message.less_than_minute":"meno di un minuto rimanente","widget.accessibility.message.remaining":"rimanenti","widget.hours.label":"Ore","widget.accessibility.message.over":"il conto alla rovescia è terminato","widget.accessibility.message.minutes":"minuti","widget.days.label":"giorni","widget.accessibility.message.hours":"ore","widget.description":"Conto alla rovescia","widget.minutes.label":"Min"});$translateProvider.translations("ja",{"widget.accessibility.message.days":"日間","widget.secs.label":"秒","widget.oncomplete.text":"カウントダウンが終了しました！","widget.accessibility.message.less_than_minute":"残り 1 分です","widget.accessibility.message.remaining":"で終了です","widget.hours.label":"時間","widget.accessibility.message.over":"カウントは終了しました","widget.accessibility.message.minutes":"分","widget.days.label":"日","widget.accessibility.message.hours":"時間","widget.description":"Countdown Clock","widget.minutes.label":"分"});$translateProvider.translations("ko",{"widget.accessibility.message.days":"일","widget.secs.label":"초","widget.oncomplete.text":"카운트다운 종료!","widget.accessibility.message.less_than_minute":"남은 시간이 1분 미만입니다.","widget.accessibility.message.remaining":"남았습니다","widget.hours.label":"시간","widget.accessibility.message.over":"카운터 종료","widget.accessibility.message.minutes":"분","widget.days.label":"일","widget.accessibility.message.hours":"시간","widget.description":"각종 이벤트 카운트다운","widget.minutes.label":"분"});$translateProvider.translations("nl",{"widget.accessibility.message.days":"dagen","widget.secs.label":"Sec.","widget.oncomplete.text":"Het wachten is voorbij!","widget.accessibility.message.less_than_minute":"nog minder dan een minuut","widget.accessibility.message.remaining":"resterend","widget.hours.label":"Uren","widget.accessibility.message.over":"aftellen is voorbij","widget.accessibility.message.minutes":"minuten","widget.days.label":"Dagen","widget.accessibility.message.hours":"uren","widget.description":"Aftelklok","widget.minutes.label":"Min."});$translateProvider.translations("no",{"widget.accessibility.message.days":"dager","widget.secs.label":"Sek","widget.oncomplete.text":"Nedtellingen er over!","widget.accessibility.message.less_than_minute":"mindre enn et minutt igjen","widget.accessibility.message.remaining":"gjenværende","widget.hours.label":"Timer","widget.accessibility.message.over":"tellingen er over","widget.accessibility.message.minutes":"minutter","widget.days.label":"Dager","widget.accessibility.message.hours":"timer","widget.description":"Nedtellingsklokke","widget.minutes.label":"Min."});$translateProvider.translations("pl",{"widget.accessibility.message.days":"dni","widget.secs.label":"Sek.","widget.oncomplete.text":"Koniec odliczania!","widget.accessibility.message.less_than_minute":"Pozostało mniej niż 1 min","widget.accessibility.message.remaining":"pozostało","widget.hours.label":"Godziny","widget.accessibility.message.over":"Odliczanie dobiegło końca","widget.accessibility.message.minutes":"minuty","widget.days.label":"Dni","widget.accessibility.message.hours":"godziny","widget.description":"Zegar odliczający","widget.minutes.label":"Minuty"});$translateProvider.translations("pt",{"widget.accessibility.message.days":"dias","widget.secs.label":"Segundos","widget.oncomplete.text":"Fim da contagem regressiva!","widget.accessibility.message.less_than_minute":"menos de um minuto restante","widget.accessibility.message.remaining":"restante","widget.hours.label":"Horas","widget.accessibility.message.over":"fim da contagem","widget.accessibility.message.minutes":"minutos","widget.days.label":"Dias","widget.accessibility.message.hours":"horas","widget.description":"Contagem Regressiva","widget.minutes.label":"Mins."});$translateProvider.translations("ru",{"widget.accessibility.message.days":"дней","widget.secs.label":"Секунд","widget.oncomplete.text":"Отсчет времени окончен","widget.accessibility.message.less_than_minute":"осталось меньше минуты","widget.accessibility.message.remaining":"остается","widget.hours.label":"Часов","widget.accessibility.message.over":"отсчет окончен","widget.accessibility.message.minutes":"минут","widget.days.label":"Дней","widget.accessibility.message.hours":"часов","widget.description":"Таймер обратного отсчета","widget.minutes.label":"Минут"});$translateProvider.translations("sv",{"widget.accessibility.message.days":"dagar","widget.secs.label":"sek.","widget.oncomplete.text":"Nedräkning är över!","widget.accessibility.message.less_than_minute":"mindre än en minut kvar","widget.accessibility.message.remaining":"återstående","widget.hours.label":"Timmar","widget.accessibility.message.over":"räkning är över","widget.accessibility.message.minutes":"minuter","widget.days.label":"Dagar","widget.accessibility.message.hours":"timmar","widget.description":"Nedräkningsklocka","widget.minutes.label":"Minuter"});$translateProvider.translations("th",{"widget.accessibility.message.days":"วัน","widget.secs.label":"วินาที","widget.oncomplete.text":"นาฬิกานับถอยหลังสิ้นสุดแล้ว!","widget.accessibility.message.less_than_minute":"เหลือน้อยกว่าหนึ่งนาที","widget.accessibility.message.remaining":"เหลือ","widget.hours.label":"ชั่วโมง","widget.accessibility.message.over":"การนับจบสิ้นแล้ว","widget.accessibility.message.minutes":"นาที","widget.days.label":"วัน","widget.accessibility.message.hours":"ชั่วโมง","widget.description":"นาฬิกานับถอยหลัง","widget.minutes.label":"นาที"});$translateProvider.translations("tr",{"widget.accessibility.message.days":"gün","widget.secs.label":"Sn","widget.oncomplete.text":"Geri Sayım Tamamlandı!","widget.accessibility.message.less_than_minute":"bir dakikadan az bir süre kaldı","widget.accessibility.message.remaining":"kaldı","widget.hours.label":"Saat","widget.accessibility.message.over":"geri sayım tamamlandı","widget.accessibility.message.minutes":"dakika","widget.days.label":"Gün","widget.accessibility.message.hours":"saat","widget.description":"Geri sayım sayacı","widget.minutes.label":"Dk."});$translateProvider.translations("zh",{"widget.accessibility.message.days":"天","widget.secs.label":"秒","widget.oncomplete.text":"倒數結束","widget.accessibility.message.less_than_minute":"還剩下不到一分鐘","widget.accessibility.message.remaining":"剩下","widget.hours.label":"小時","widget.accessibility.message.over":"倒數結束","widget.accessibility.message.minutes":"分鐘","widget.days.label":"天","widget.accessibility.message.hours":"小時","widget.description":"倒數時鐘","widget.minutes.label":"分鐘"});$translateProvider.preferredLanguage(locale).fallbackLanguage("en").useSanitizeValueStrategy(null)}).config(function($routeProvider,$locationProvider){$routeProvider.when("/mobile",{controller:"HomeController",templateUrl:"views/home/home.html"}).when("/index",{templateUrl:function templateUrl(){var mainUrl="views/home/home.html";var mobileUrl="views/home/home.html";var deviceType=Wix.Utils.getDeviceType();if(deviceType==="mobile"){return mobileUrl}return mainUrl},controller:function controller(){var mainController="HomeController";var mobileController="HomeController";var deviceType=Wix.Utils.getDeviceType();if(deviceType==="mobile"){return mobileController}return mainController}}).otherwise({redirectTo:"/index"});$locationProvider.html5Mode(true)});"use strict";angular.module(initialState.appName).filter("html",["$sce",function($sce){return function(text){try{return $sce.trustAsHtml(text.toLocaleString())}catch(e){console.log("text:".concat(text," error:").concat(e.message));return text}}}]);angular.module(initialState.appName).filter("capitalize",function(){return function(input,scope){if(input!==null)return input.substring(0,1).toUpperCase()+input.substring(1)}});"use strict";(function(){function Wix($window,$location,$timeout){var wix=$window.Wix;var url=$location.absUrl();wix.getParamFromURL=function(name){var val;try{val=new URLSearchParams($window.location.search).get(name)}catch(err){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex=new RegExp("[\\?&]"+name+"=([^&#]*)");var results=regex.exec($window.location.search);val=results===null?"":decodeURIComponent(results[1].replace(/\+/g," "))}return val};wix.myNavigateTo=function(link){link=JSON.parse(link.replace(/\~#~/g,'"'));return wix.navigateTo(link)};wix.Utils.getInstance=function(){var instanceRegexp=/.*instance=([\[\]a-zA-Z0-9\.\-_]*?)(&|$|#).*/g;var instance=instanceRegexp.exec(url);return instance&&instance[1]?instance[1]:undefined};wix.isMobile=function(){return wix.Utils.getDeviceType()=="mobile"};wix.isEditorMode=function(){return wix.Utils.getViewMode()=="editor"};wix.isSiteMode=function(){return wix.Utils.getViewMode()=="site"};wix.isPreviewMode=function(){return wix.Utils.getViewMode()=="preview"};var myKey="mobileResize2";wix.getDataValue=function(cbOK,cbError){wix.Data.Public.get(myKey,{scope:"COMPONENT"},cbOK,cbError)};wix.setDataValue=function(data,cbOK,cbError){if(!wix.isEditorMode()){return}wix.Data.Public.set(myKey,data,{scope:"COMPONENT"},cbOK,cbError)};wix.isIOS=function(){var userAgent=navigator.userAgent.toLowerCase(),isIPhone=userAgent.indexOf("iphone")>=0,isIPod=userAgent.indexOf("ipod")>=0,isIPad=userAgent.indexOf("ipad")>=0;return isIPhone||isIPod||isIPad};wix.isIE=function(){var userAgent=window.navigator.userAgent.toLowerCase();return/(msie|trident)/i.test(userAgent||"")};wix.isSafari=function(){var userAgent=window.navigator.userAgent.toLowerCase();return/(safari)/i.test(userAgent||"")};wix.isIPhone=function(){var userAgent=navigator.userAgent.toLowerCase(),isIPhone=userAgent.indexOf("iphone")>=0;return isIPhone};wix.isIpad=function(){var userAgent=navigator.userAgent.toLowerCase(),isIPad=userAgent.indexOf("ipad")>=0;return isIPad};wix.isPremium=function(){return false};wix.getAppIds=function(){var instanceId=wix.Utils.getInstanceId();var biToken=wix.Utils.getInstanceValue("biToken")||"";var metaSiteId=wix.Utils.getInstanceValue("metaSiteId")||"";var obj={instanceId:instanceId,metaSiteId:metaSiteId,biToken:biToken};return obj};wix.getCookieKey=function(keyName){var compId=wix.Utils.getOrigCompId()||wix.Utils.getCompId();var cookieKey=[keyName,wix.Utils.getInstanceId(),compId].join("_");return cookieKey};wix.setMyHeight=function(height){wix.setHeight(height);return height};return wix}Wix.$inject=["$window","$location","$timeout"];angular.module(initialState.appName).service("wixService",Wix)})();"use strict";(function(){angular.module(initialState.appName).service("biService",["wixService",function(wixService){var srcNum=63,siteId="",self=this,publishSiteEvId=213;var events=[["clickOnTab",11,["tab_name"]],["savePublish",publishSiteEvId,["event_trigger","wixlabs_string_1","wixlabs_bool_1","wixlabs_bool_2","wixlabs_bool_3"]]];var appIds=wixService.getAppIds();var superProperties={Uid:wixService.Utils.getUid(),InstanceId:wixService.Utils.getInstanceId(),CompId:wixService.Utils.getCompId(),OrigCompId:wixService.Utils.getOrigCompId(),IsPremium:wixService.isPremium(),siteId:appIds.metaSiteId,visitorId:wixService.Utils.getInstanceValue("aid")};self.getCompId=function(){return superProperties.CompId.indexOf("comp")>-1?superProperties.CompId:superProperties.OrigCompId};self.getInstanceId=function(){return superProperties.InstanceId};var frogSuperProperties={app_id:initialState.APP_ID,app_site_id:self.getInstanceId(),biToken:appIds.biToken,instance_id:self.getCompId(),uuid:superProperties.Uid};var onSuccessDef=function onSuccessDef(){};var onErrorDef=function onErrorDef(){};self.noop=function(){};var report=function report(params,bUserEvent,onSuccess,onError){var url=bUserEvent?"//frog.wix.com/wixlabs-ugc?":"//frog.wix.com/wixlabs-users?",cacheKiller="_="+(new Date).getTime(),bi=new Image;if(params.evid===publishSiteEvId||bUserEvent){if(!bUserEvent){delete params.origin}delete params.market}if(bUserEvent){delete params.app_site_id;delete params.tab_name;delete params.site_id;delete params.uuid;params.comp_id=self.getCompId();params.instance_id=self.getInstanceId();params.visitor_id=superProperties.visitorId}bi.onload=onSuccess||onSuccessDef;bi.onerror=onError||onErrorDef;var BIURL=url+cacheKiller+"&src="+srcNum+"&"+Object.keys(params).map(function(key){return[encodeURIComponent(key),"=",encodeURIComponent(params[key])].join("")}).join("&");if(bUserEvent&&!wixService.isSiteMode()){return}if(bUserEvent&&!wixService.isSiteMode())return;bi.src=BIURL};var eventClosure=function eventClosure(eventParams,paramsOrder,sUserEvent){return function(){var bUserEvent=!!sUserEvent&&sUserEvent==="user",onSuccess=arguments[1]||self.noop,onError=arguments[2]||self.noop,params=arguments[0]||[];for(var i=0;i<paramsOrder.length;i++){eventParams[paramsOrder[i]]=params[i]}report(eventParams,bUserEvent,onSuccess,onError)}};self.init=function(){for(var i=0;i<events.length;i++){var event=events[i],eventParams=$.extend({evid:event[1]},frogSuperProperties);for(var j=0;j<event[2];j++){event[2][j]=""}self[event[0]]=eventClosure(eventParams,event[2],event[3])}};self.init()}])})();"use strict";(function(){function http($http){var that=this;var requestParams=document.location.search;this.jsonToParams=function(data){data=data||{};var urlParameters=Object.keys(data).map(function(key){return key+"="+encodeURIComponent(data[key])}).join("&");return urlParameters||""};this.post=function(url,params){return $http.post(url+requestParams,params)};this.freeRequest=function(urlRequestObject){return $http(urlRequestObject)};this.delete=function(url){return $http.delete(url+requestParams)};this.get=function(url,params,asUrl){var fullUrl=url+requestParams;var parsedParams=that.jsonToParams(params);if(parsedParams.length){fullUrl+="&"+parsedParams}if(asUrl)return fullUrl;return $http.get(fullUrl)}}http.$inject=["$http"];angular.module(initialState.appName).service("httpService",http)})();"use strict";angular.module(initialState.appName).service("commonService",function(httpService,$translate,wixService,$q,$timeout){this.g_allSettings=null;this.postTimer=null;this.gXHR=null;var that=this,canceler=$q.defer(),oldSettings=null;this.log=function log(text){if(window.console&&window.console.log){window.console.log(text)}};this.refreshWidget=function(){wixService.Settings.refreshAppByCompIds([wixService.Utils.getOrigCompId()])};this.getLocale=function(defaultLocale){var locale=wixService.Utils.getLocale();locale=locale.toLowerCase().replace(/[^a-zA-Z]+/g,"");return locale.length===2?locale:defaultLocale};this.checkURL=function(str){var options={};return validator.isURL(str,options)};this.isIE=function(){var userAgent=window.navigator.userAgent.toLowerCase();return/(msie|trident)/i.test(userAgent||"")};this.isSafari=function(){var userAgent=window.navigator.userAgent.toLowerCase();return/(safari)/i.test(userAgent||"")};this.openPopup=function(url,width,height,title,scroller){var w=width,h=height,left=window.screen.width/2-w/2,top=window.screen.height/2-h/2;var resizable=scroller=scroller?"yes":"no";var win=window.open(url,"settingspopup","toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars="+scroller+", resizable="+resizable+", copyhistory=no, width="+w+", height="+h+", top="+top+", left="+left);try{if(win!=null&&win.moveTo)win.moveTo(left,top);if(win!=null)win.focus()}catch(e){}};this.canResize=function(){return true};this.supports_html5_storage=function(){try{return"localStorage"in window&&window["localStorage"]!==null}catch(e){return false}};this.wixHandlers=function(){if(wixService.Utils.getDemoMode())return;wixService.addEventListener(wixService.Events.COMPONENT_DELETED,function(params){httpService.delete("/api/delete").then(function(data){console.log("delete api: ",data)})})};this.getWinHeight=function(){return angular.element($window).height()};this.adjustHeight=function(){var isMobile=wixService.Utils.getDeviceType()==="mobile";$(window).ready(function(){setTimeout(function(){var height=that.getWinHeight();if(height){wixService.setHeight(height)}},0)})};this.onResizeWindow=function(){that.resizeWindow();$(window).resizeend({delay:600},function(){that.resizeWindow()})};this.resizeWindow=function(){if(!that.canResize())return;that.adjustHeight()};this.getTranslateByKey=function(key){return $translate.instant(key,{},{},wixService.Utils.getLocale())};this.getCookieKey=function(){return[wixService.Utils.getInstanceId(),wixService.Utils.getCompId()].join("_")};this.postHive=function(description){if(wixService.Utils.getViewMode()!=="site"){log("Error: Invalid view mode. This function cannot be called in editor/preview mode. Supported view mode is: [site]");return false}try{var activity={type:wixService.Activities.Type.CONVERSION_COMPLETE,info:{conversionType:"CTA_CLICK",messageId:getCookieKey(),metadata:[{name:"countdown clock",value:description}]}};var onSuccess=function onSuccess(d){log("Success: Activity ID: "+d.activityId+", Contact ID: "+d.contactId)};var onFailure=function onFailure(d){log("Failure message:"+d)};wixService.Activities.postActivity(activity,onSuccess,onFailure)}catch(err){log("PostHive Error: ",err)}};if(!String.prototype.endsWith){String.prototype.endsWith=function(searchString,position){var subjectString=this.toString();if(typeof position!=="number"||!isFinite(position)||Math.floor(position)!==position||position>subjectString.length){position=subjectString.length}position-=searchString.length;var lastIndex=subjectString.indexOf(searchString,position);return lastIndex!==-1&&lastIndex===position}}this.strip_tags=function(input,allowed){input=""+input;allowed=(((allowed||"")+"").toLowerCase().match(/<[a-z][a-z0-9]*>/g)||[]).join("");var tags=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi;var commentsAndPhpTags=/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi;return input.replace(commentsAndPhpTags,"").replace(tags,function($0,$1){return allowed.indexOf("<"+$1.toLowerCase()+">")>-1?$0:""})};this.saveSettingsOnCloseSettingsWindow=function(){var key="settings_"+Wix.Utils.getCompId(),data=localStorage.getItem(key),allSettings=JSON.parse(data),searchString=document.location.search+"&origCompId="+Wix.Utils.getCompId();if(allSettings){httpService.post("/api/settings",allSettings).then(function(result){location.reload()});localStorage.removeItem(key)}};this.saveSettings=function(newSettings,refreshWidget){canceler.resolve();$timeout(function(){canceler=$q.defer();var allSettings={settings:newSettings};if(oldSettings===allSettings){$log.log("same");return}if(that.gXHR!==null){try{canceler.resolve()}catch(err){$log.log("error:",err)}}that.gXHR=httpService.post("/api/settings",allSettings).success(function(result,status,headers,config){oldSettings=newSettings;if(refreshWidget){}that.gXHR=null}).error(function(data,status,headers,config){that.gXHR=null;that.inited=true})},500)}});"use strict";angular.module(initialState.appName).service("styleService",["INITIAL_STATE","$timeout","$log",function(INITIAL_STATE,$timeout,$log){var settings,styleParams,css,isMobile,design=INITIAL_STATE.design;function initParams(aSettings,aStyleParams,aisMobile){try{isMobile=aisMobile;settings=aSettings;styleParams=angular.extend({colors:[],fonts:[]},aStyleParams);css=""}catch(e){$log.info(e)}}function getValue(obj){if(angular.isObject(obj)&&obj.hasOwnProperty("value"))return obj.value;return obj}function jointCSS(){var css=[];try{var wixBackgroundColor=styleParams.colors.counterBackgroundColor?styleParams.colors.counterBackgroundColor:design.counter_design.background;var bgColor=getValue(wixBackgroundColor);if(!tinycolor(bgColor).isValid()){bgColor=getValue(Wix.Styles.getColorByreference(wixBackgroundColor))}bgColor=tinycolor(bgColor);var alpha=styleParams.colors.counterBackgroundColor?bgColor.getAlpha():design.counter_design.background.opacity}catch(e){console.log("error in styleservice",e)}return css}function styleMobile(){var css=jointCSS();var finalCSS=css.join("");return finalCSS}function styleWidget(){var css=jointCSS();var finalCSS=css.join("");return finalCSS}this.applyLayoutStyleOld=function(aSettings,aStyleParams,aisMobile){initParams(aSettings,aStyleParams,aisMobile);var backgroundColor=jointCSS();return backgroundColor};this.applyLayoutStyle=function(aSettings,aStyleParams,aisMobile){initParams(aSettings,aStyleParams,aisMobile);settings.layout=settings.layout||"mywigdetstyle";var styleCSS="",styleId="myStyleInject"+settings.layout.type;styleCSS=isMobile?styleMobile():styleWidget();try{angular.element("#"+styleId).remove()}catch(e){}angular.element('<style type="text/css" id="'+styleId+'">'+styleCSS+"</style>").appendTo("head")}}]);"use strict";function getLocale(defaultLocale){var locale=Wix.Utils.getLocale()||defaultLocale;locale=locale.toLowerCase().replace(/[^a-zA-Z]+/g,"");if(locale.length===2){return locale}return defaultLocale}angular.module(initialState.appName).config(function($routeProvider){$routeProvider.when("/index-desktop",{template:"<main></main>"})});if(!window.console){window.console={}}if(!window.console.log){window.console.log=function(message){}}"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function")}}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){if(protoProps)_defineProperties(Constructor.prototype,protoProps);if(staticProps)_defineProperties(Constructor,staticProps);return Constructor}(function(){var HomeController=function(){function HomeController($scope,$window,$interval,$translate,$timeout,$q,biService,INITIAL_STATE,wixService,httpService,commonService,styleService,$document,$rootScope){_classCallCheck(this,HomeController);this.httpService=httpService;this.settings={show:false};this.$window=$window;this.$document=$document;this.$timeout=$timeout;this.$interval=$interval;this.$scope=$scope;this.biService=biService;this.styleService=styleService;this.$translate=$translate;this.wixService=wixService;this.commonService=commonService;this.initialState=INITIAL_STATE;this.constants=INITIAL_STATE;this.instanceId=wixService.Utils.getInstanceId();this.settings=this.initialState.data.settings;this.design=this.initialState.design;this.inited=false;this.popoverContent=null;this.Timer=null;this.is_complete=false;this.clicked=false;this.$scope.viewMode=this.wixService.Utils.getViewMode();this.$rootScope=$rootScope;this.$rootScope.timerText="";this.oldHeight=-1}_createClass(HomeController,[{key:"applyChangesToScope",value:function applyChangesToScope(fn){this.$timeout(fn)}},{key:"getTranslateByKey",value:function getTranslateByKey(key){return this.$translate.instant(key,{},{},this.settings.editor_lang)}},{key:"isMobile",value:function isMobile(){var that=this;return that.wixService.isMobile()}},{key:"bool2String",value:function bool2String(val){return val?"true":"false"}},{key:"biSavePublish",value:function biSavePublish(eventType){var that=this;var settings=that.settings;try{that.biService.savePublish([eventType,that.settings.on_complete==="show"?"message":"nothing",that.bool2String(that.settings.style),that.bool2String(that.display_days),that.bool2String(that.display_seconds)])}catch(e){console.log("error in save/publish",e)}}},{key:"getDiffInHours",value:function getDiffInHours(){var dt=that.timeSettingToTime();var timeTo=that.timer.timeTo(dt);var total_hours=timeTo.orig_days*24+timeTo.orig_hours;return total_hours}},{key:"isIOS",value:function isIOS(){var userAgent=navigator.userAgent.toLowerCase(),isIPhone=userAgent.indexOf("iphone")>=0,isIPod=userAgent.indexOf("ipod")>=0,isIPad=userAgent.indexOf("ipad")>=0;return isIPhone||isIPod||isIPad}},{key:"isIpad",value:function isIpad(){var userAgent=navigator.userAgent.toLowerCase(),isIPad=userAgent.indexOf("ipad")>=0;return isIPad}},{key:"handleStylesChangeEvent",value:function handleStylesChangeEvent(){var that=this;return function(styleParams){styleParams=styleParams||that.design;that.styleParams=styleParams;that.styleParams.colors=styleParams.colors||{};that.styleService.applyLayoutStyle(that.settings,that.styleParams,that.isMobile())}}},{key:"resizeWidget",value:function resizeWidget(){var that=this;that.inited=true;return}},{key:"isEditorMode",value:function isEditorMode(){var that=this;return that.wixService.Utils.getViewMode()==="editor"}},{key:"handleEventListeners",value:function handleEventListeners(){var that=this;var bShowPreview=false;that.wixService.addEventListener(that.wixService.Events.SETTINGS_UPDATED,function(data){var refreshSettings=angular.isUndefined(data.refreshSettings)?true:data.refreshSettings;that.applyChangesToScope(function(){that.Timer=that.InitTimer();if(!refreshSettings&&bShowPreview&&!data.preview){if(that.Timer!==null){that.Timer.restart(that.timeSettingToTime())}}else{bShowPreview=data.preview||false;var oldSetttings=that.settings.style;that.settings=data.settings;if(oldSetttings!==that.settings.style){angular.element(".timer .inn").text("")}that.stripSettingsTags();that.wixService.Styles.getStyleParams(function(styleParams){that.handleStylesChangeEvent()(styleParams);that.Timer=that.InitTimer();if(refreshSettings){that.Timer.restart(that.timeSettingToTime())}if(bShowPreview){that.Timer.showDone()}that.$timeout(function(){angular.element(window).trigger("resize")},100)})}})});that.wixService.addEventListener(that.wixService.Events.STYLE_PARAMS_CHANGE,function(styleParams){that.handleStylesChangeEvent()(styleParams);if(that.Timer!==null){that.Timer.restart(that.timeSettingToTime());that.$timeout(function(){angular.element(window).trigger("resize")},100)}if(bShowPreview){that.Timer.showDone()}});that.wixService.addEventListener(that.wixService.Events.SITE_SAVED,function(){});that.wixService.addEventListener(that.wixService.Events.SITE_PUBLISHED,function(){that.biSavePublish("publish")});that.commonService.wixHandlers()}},{key:"timerStyle",value:function timerStyle(root,options){options.width=Math.floor(options.width);options.height=options.height||options.width*60/190;options.height=Math.floor(options.height);root.find(".wrapper, .complete-text").css({width:options.width+"px",height:options.height+"px"});root.find(".value, .separator .space").css({height:options.height*40/60+"px","font-size":options.height*25/60+"px","line-height":options.height*40/60+"px"});var fontSize=options.width*60/190-2*options["borderWidth"]+"px";root.find(".complete-text").css({width:"97%",height:"97%"});root.find(".value").css({height:options.height*40/60+"px"});root.find(".text").css({height:options.height*13/60+"px","line-height":options.height*13/60+"px","font-size":options.height*10/60+"px","margin-top":options.height*7/60+"px"});root.find("ul.flip").css({"border-radius":options.height*3/60+"px"});root.find("ul.flip li .front-and-back div div.inn").css({"text-shadow":"none","border-radius":options.height*3/60+"px"});root.find(".value, ul.flip li .front-and-back div div.inn,  .text").css({background:options["fullBG"]});options.height=options.width*60/190-2*options["borderWidth"];options.height=Math.floor(options.height)}},{key:"adjustVal",value:function adjustVal(val){return Math.floor(val)}},{key:"timerStyle1",value:function timerStyle1(root,options){var that=this;var digitsColor=options["color"];var backgroundColor=options["backgroundColor"];if(that.styleParams.colors["DigitsColor"]){digitsColor=that.styleParams.colors["DigitsColor"].value}if(digitsColor===""){digitsColor=that.wixService.Styles.getColorByreference(that.design.counter_design.digits.textColor.value).value}if(that.styleParams.colors["counterBackgroundColor"]){backgroundColor=that.styleParams.colors["counterBackgroundColor"].value}if(backgroundColor===""&&that.settings.oldSettings.bgcolor===""){backgroundColor=that.wixService.Styles.getColorByreference(that.design.counter_design.background.value).value}options["color"]=digitsColor;options["backgroundColor"]=backgroundColor;options["opacity"]=tinycolor(backgroundColor).getAlpha();options["fullBG"]=tinycolor(backgroundColor).setAlpha(1);options["textShadowColor"]=tinycolor(digitsColor).darken(25).toString();this.timerStyle(root,options);root.find(".wrapper").css({background:"transparent"});root.find(".value").css({});root.css({opacity:options["opacity"]});root.find(".inn").css({height:options["height"]*40/60+"px","font-size":options["height"]*25/60+"px","line-height":options["height"]*40/60+"px"});root.find(".value, ul.flip li .front-and-back div div.inn,  .text").css({background:options["fullBG"]});root.find(".text").css({});root.find(".text").css({});root.find("ul.flip li .front-and-back div.down, ul.flip li .down .shadow").css({"border-bottom-left-radius":options["height"]*3/60+"px","border-bottom-right-radius":options["height"]*3/60+"px"});root.find("ul.flip li .front-and-back div.up, ul.flip li .up .shadow").css({"border-top-left-radius":options["height"]*3/60+"px","border-top-right-radius":options["height"]*3/60+"px"});root.find("ul.flip li .front-and-back").css({"-webkit-perspective":options["width"]/2+"px","-moz-perspective":options["width"]/2+"px","-o-perspective":options["width"]/2+"px","-ms-perspective":options["width"]/2+"px",perspective:options["width"]/2+"px"});root.find(".separator").css({width:"8%"})}},{key:"timerStyle2",value:function timerStyle2(root,options){root.find(".inn").css({height:this.adjustVal(options["height"]*40/60)+"px","font-size":this.adjustVal(options["height"]*25/60)+"px","line-height":this.adjustVal(options["height"]*40/60)+"px"});this.timerStyle(root,options);var that=this;var backgroundColor=options["backgroundColor"];if(that.styleParams.colors["counterBackgroundColor"]){backgroundColor=that.styleParams.colors["counterBackgroundColor"].value}options["backgroundColor"]=backgroundColor;root.find(".value, ul.flip li .front-and-back div div.inn,  .text").css({background:"none"});root.find("ul.flip li .front-and-back").css({"-webkit-perspective":"none","-moz-perspective":"none","-o-perspective":"none","-ms-perspective":"none",perspective:"none"});root.find(".wrapper").css({background:backgroundColor,width:options["width"]-2*options["borderWidth"]+"px",height:options["height"]+"px"});var fontFamily=root.find(".wrapper").css("fontFamily");var multiplier=25;var spacing=fontFamily.indexOf("monospace")>-1?5:6;root.find(".separator").css({width:spacing+"%"});root.find(".value, .value .inn, .separator .space").css({"font-size":this.adjustVal(options["height"]*multiplier/60)+"px"});root.find(".text").css({"margin-top":options["height"]*3/60+"px"});root.find(".text").css({"box-shadow":"none","text-shadow":"none"});root.find(".value").css({"text-shadow":"none","box-shadow":"none"})}},{key:"InitTimer",value:function InitTimer(){if(this.Timer!=null)return this.Timer;var that=this;var Timer=function(){function has3d(){var el=document.createElement("p"),has3d,transforms={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(el,null);for(var t in transforms){if(el.style[t]!==undefined){el.style[t]="translate3d(1px,1px,1px)";has3d=window.getComputedStyle(el).getPropertyValue(transforms[t])}}document.body.removeChild(el);return has3d!==undefined&&has3d.length>0&&has3d!=="none"}var formatNumber=function formatNumber(number,sign){sign=sign||1;var text;if(number===0){text=sign>0?"00":"-0"}else{number=number*sign;text=number.toString();if(text.length==1){text=(sign>0?"0":"-")+text}}return text};var transition3D=function transition3D(element,text){var current=element.filter(".active"),next;if(current.size()===0){current=element.eq(0);next=element.eq(1)}else{if(current.is(":last-child")){next=element.eq(0)}else{next=current.next("li")}}next.find(".inn").text(text);element.removeClass("before");current.addClass("before").removeClass("active");next.addClass("active")};var transition2D=function transition2D(element,text){element.find(".inn").text(text)};var timeTo=function timeTo(date){var now=new Date;var distance=date-now;var sign=distance>0?1:-1;distance=Math.abs(parseInt(distance/1e3,10));var days,hours,minutes,seconds;var orig_hours=0,orig_days=0;seconds=distance%60;distance=parseInt(distance/60,10);minutes=distance%60;distance=parseInt(distance/60,10);hours=distance%24;distance=parseInt(distance/24,10);days=distance;orig_hours=hours;orig_days=days;if(that.settings.display_days!==1){hours+=days*24;days=0;hours=(""+hours).substring(3,-1)*1}return{sign:sign,days:days,hours:hours,minutes:minutes,seconds:seconds,orig_hours:orig_hours,orig_days:orig_days}};var stop=function stop(interval,view){view.el.find(".inn").text("00");return false};var continueCounting=function continueCounting(interval,view){interval.tick=tickFrom;if(interval.sign>0){interval.sign=-1;interval.days=0;interval.hours=0;interval.minutes=0;interval.seconds=1}return true};var showText=function showText(interval,view){view.el.addClass("complete");that.is_complete=true;that.applyChangesToScope(function(){that.$document[0].title=that.$window.title=that.$rootScope.timerText=[that.getTranslateByKey("widget.description"),"-",that.getTranslateByKey("widget.accessibility.message.over")].join(" ")});return false};var completeCallbacks={show:showText,continue:continueCounting,stop:stop};var updateView=function updateView(interval,view,transition,changes){if(changes.daysChanged){transition(view.days,formatNumber(interval.days,interval.sign))}if(changes.hoursChanged){transition(view.hours,formatNumber(interval.hours))}if(changes.minutesChanged){transition(view.minutes,formatNumber(interval.minutes))}transition(view.seconds,formatNumber(interval.seconds))};var tickTo=function tickTo(interval,view,transition,callback){var repeat=true,minutesChanged=false,hoursChanged=false,daysChanged=false;interval.seconds--;if(interval.seconds<0){interval.seconds=59;interval.minutes--;if(interval.minutes<0){interval.minutes=59;interval.hours--;if(interval.hours<0){interval.hours=23;interval.days--;if(interval.days<0){repeat=callback(interval,view)}daysChanged=true}hoursChanged=true}minutesChanged=true}if(repeat){updateView(interval,view,transition,{daysChanged:daysChanged,hoursChanged:hoursChanged,minutesChanged:minutesChanged})}return repeat};var tickFrom=function tickFrom(interval,view,transition,callback){var minutesChanged=false,hoursChanged=false,daysChanged=false;interval.seconds++;if(interval.seconds>59){interval.seconds=0;interval.minutes++;if(interval.minutes>59){interval.minutes=0;interval.hours++;if(interval.hours>23){interval.hours=0;interval.days++;daysChanged=true}hoursChanged=true}minutesChanged=true}updateView(interval,view,transition,{daysChanged:daysChanged,hoursChanged:hoursChanged,minutesChanged:minutesChanged});return true};var timeout;var restart=function restart(timestamp){window.clearTimeout(timeout);that.is_complete=false;timer(timestamp)};var showDone=function showDone(){var view={el:$(".timer"),days:$("ul.days-play li"),hours:$("ul.hours-play li"),minutes:$("ul.mins-play li"),seconds:$("ul.secs-play li")};showText(0,view)};var timer=function timer(timestamp){var interval=timeTo(new Date(timestamp));var style_type=that.settings.style;var view={el:$(".timer"),days:$("ul.days-play li"),hours:$("ul.hours-play li"),minutes:$("ul.mins-play li"),seconds:$("ul.secs-play li")};var body=$("body");if(style_type=="1"){that.settings.border_width=0}var options={style:that.settings.style,font:that.settings.oldSettings.font,color:that.settings.oldSettings.textcolor,backgroundColor:that.settings.oldSettings.bgcolor,opacity:that.settings.oldSettings.opacity,has_border:1,border_color:that.settings.oldSettings.bordercolor,borderWidth:that.settings.border_width,complete:that.settings.on_complete};if(options["backgroundColor"]!==""&&style_type=="2"){options["backgroundColor"]=tinycolor(options["backgroundColor"]).setAlpha(that.settings.oldSettings.opacity).toString()}var digitsColor=options["color"];var backgroundColor=options["backgroundColor"];if(that.styleParams.colors["DigitsColor"]){digitsColor=that.styleParams.colors["DigitsColor"].value}if(that.styleParams.colors["counterBackgroundColor"]){backgroundColor=that.styleParams.colors["counterBackgroundColor"].value;options["opacity"]=tinycolor(backgroundColor).getAlpha()}options["color"]=digitsColor;options["backgroundColor"]=backgroundColor;options["fullBG"]=tinycolor(backgroundColor).setAlpha(1);options["textShadowColor"]=tinycolor(digitsColor).darken(25).toString();var resizeTimer=null;$(window).off("resize").on("resize",function(data){that["timerStyle"+style_type](view.el,$.extend(options,{width:body.width()*.93}));var newHeight=view.el.outerHeight(true);if(that.wixService.isSiteMode()){that.wixService.setMyHeight(newHeight)}else{if(resizeTimer)that.$timeout.cancel(resizeTimer);resizeTimer=that.$timeout(function(){that.wixService.setMyHeight(newHeight);that.oldHeight=newHeight},250)}});if(!that.wixService.isSiteMode()){that.$interval(function(){var newHeight=view.el.outerHeight(true);if(!that.isMobile()){if(that.oldHeight!=newHeight){that.wixService.setMyHeight(newHeight);that.oldHeight=newHeight}}},250)}that["timerStyle"+style_type](view.el,$.extend(options,{width:body.width()*.93}));var transition=has3d()?transition3D:transition2D;if(style_type=="2"){transition=transition2D}var callback=completeCallbacks[that.settings.on_complete]||completeCallbacks["stop"];that.daysFormatted=formatNumber(interval.days,interval.sign);view.days.find(".inn").text(that.daysFormatted);if(that.daysFormatted.indexOf("-")>-1)that.daysFormatted="00";view.hours.find(".inn").text(formatNumber(interval.hours));view.minutes.find(".inn").text(formatNumber(interval.minutes));view.seconds.find(".inn").text(formatNumber(interval.seconds));interval.tick=tickTo;var repeat;var timerFunc=function timerFunc(){body.removeClass("play");repeat=interval.tick(interval,view,transition,callback);body.addClass("play");if(repeat){timeout=setTimeout(timerFunc,1e3)}that.applyChangesToScope(function(){if(interval.days<0){that.$document[0].title=that.$window.title=that.$rootScope.timerText=[that.getTranslateByKey("widget.description"),"-",that.getTranslateByKey("widget.accessibility.message.over")].join(" ")}else{if(interval.days*interval.hours*interval.minutes==0&&interval.seconds>0){that.$document[0].title=that.$window.title=that.$rootScope.timerText=[that.getTranslateByKey("widget.description"),"-",that.getTranslateByKey("widget.accessibility.message.less_than_minute")].join(" ")}else{that.$document[0].title=that.$window.title=that.$rootScope.timerText=[that.getTranslateByKey("widget.description"),"-",interval.days,that.getTranslateByKey("widget.accessibility.message.days"),",",interval.hours,that.getTranslateByKey("widget.accessibility.message.hours"),",",interval.minutes,that.getTranslateByKey("widget.accessibility.message.minutes"),that.getTranslateByKey("widget.accessibility.message.remaining")].join(" ")}}})};repeat=interval.sign<0?callback(interval,view):true;var height=view.el.outerHeight(true);if(that.oldHeight!=height){that.wixService.setMyHeight(height);that.oldHeight=height}if(repeat){timeout=setTimeout(timerFunc,1e3)}};return{start:timer,restart:restart,showDone:showDone,timeTo:timeTo}}();return Timer}},{key:"findMomentTZ",value:function findMomentTZ(tz){var momentTZList=moment.tz.names();var city=tz.split("/").pop();var momentTZ=momentTZList.filter(function(val){return val.indexOf(tz)>-1});if(momentTZ.length){return momentTZ[0]}else{var offset="UTC";return offset}}},{key:"timeSettingToTime",value:function timeSettingToTime(){var that=this;var offset=this.findMomentTZ(that.settings.countdown_tz);if(isNaN(offset)){offset=moment.tz(offset).format("Z")}var parsedDate=that.settings.countdown_at.replace(/\dZ/,offset);var nd=new Date(Date.parse(parsedDate));nd.setSeconds(0);return nd.getTime()}},{key:"startTimer",value:function startTimer(){var that=this;that.Timer=that.InitTimer()}},{key:"stripSettingsTags",value:function stripSettingsTags(){var that=this;var settings=that.settings;var fields=["label_days","label_hours","label_minutes","label_seconds","on_complete_text"];angular.forEach(fields,function(val){settings[val]=that.commonService.strip_tags(settings[val])})}},{key:"handleEditorLang",value:function handleEditorLang(){var that=this;if(that.isEditorMode()){if(angular.isUndefined(that.settings.editor_lang)||angular.equals(that.settings.editor_lang,"")){that.settings.editor_lang=that.settings.lang=that.wixService.Utils.getLocale();that.httpService.post("/api/lang",{})}}}},{key:"$onInit",value:function $onInit(){var that=this;that.stripSettingsTags();that.handleEditorLang();that.wixService.Styles.getStyleParams(function(styleParams){that.handleStylesChangeEvent()(styleParams);var style_type=that.settings.style;angular.element(".timer.timer-style-"+style_type).ready(function(){that.Timer=that.InitTimer();that.Timer.start(that.timeSettingToTime());that.$timeout(function(){angular.element(window).trigger("resize");angular.element(".timer").removeClass("hidden");that.wixService.Performance.applicationLoaded()},100)})});that.handleEventListeners()}}]);return HomeController}();angular.module(initialState.appName).controller("HomeController",HomeController)})();